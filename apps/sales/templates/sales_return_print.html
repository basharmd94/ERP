<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Sales Return</title>
  <style>
    /* Define page and footer frames */
    @page {
      size: letter;
      margin: 0.5in 0.5in 0.8in 0.5in;

      /* Footer frame at bottom */
      @frame footer_frame {
        -pdf-frame-content: footerContent;
        bottom: 0in;
        margin-left: 0.5in;
        margin-right: 0.5in;
        height: 0.8in;
      }
    }

    body {
      font-family: Arial, sans-serif;
      font-size: 10px;
      line-height: 1.2;
      margin: 0;
      padding: 0;
      color: #000;
    }

    /* Table styles */
    .return-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
      margin: 8px 0;
      font-size: 9px;
    }

    .return-table th,
    .return-table td {
      border: 1px solid #000;
      padding: 2px;
      text-align: center;
      word-wrap: break-word;
    }

    .return-table th {
      background-color: #f0f0f0;
      font-weight: bold;
      font-size: 10px;
    }

    .return-table .left {
      text-align: left;
      line-height: 1.4;
    }

    .return-table .right {
      text-align: right;
    }

    .summary-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 8px;
      margin: 5px 0;
    }

    .summary-table td {
      border: 1px solid #000;
      padding: 2px 4px;
    }

    .summary-table .label {
      text-align: left;
      font-weight: bold;
    }

    .summary-table .amount {
      text-align: right;
    }
  </style>
</head>

<body>

  <!-- Company Header -->
  <div style="text-align: center; margin-bottom: 2px;">
    <div style="font-size: 20px; font-weight: bold;">
      {{ business.business_name|default:"My Business" }}
    </div>
    <div>{{ business.business_address|default:"My Business Address" }}</div>
    <div>Mobile: {{ business.business_mobile|default:"My Business Mobile" }}</div>
    <div>Email: {{ business.business_email|default:"My Business Email" }}</div>
    <div>Website: {{ business.business_website|default:"My Business Website" }}</div>
    <div style="font-size: 14px; font-weight: bold; text-decoration: underline; margin-top: 10px;">
      SALES RETURN
    </div>
  </div>

  <!-- Return Information -->
  <div style="margin-bottom: 8px;">
    <table style="width: 100%; border-collapse: collapse; font-size: 10px;">
      <tr>
        <td style="width: 50%;">
          <strong>Transaction No:</strong> {{ header.ximtmptrn }}<br>
          <strong>Warehouse:</strong> {{ header.xwh }}<br>
          <strong>Project:</strong> {{ header.xproj|default:"-" }}
        </td>
        <td style="width: 50%; text-align: right;">
          <strong>Date:</strong> {{ header.xdate }}<br>
          <strong>GL Reference:</strong> {{ header.xglref|default:"-" }}<br>
          <strong>Status:</strong> {{ header.xstatustrn|default:"Processed" }}
        </td>
      </tr>
    </table>
  </div>

  {% if line_items %}
  <table class="return-table">
    <thead>
      <tr>
        <th style="width: 5%;">S.I.</th>
        <th style="width: 12%;">Code</th>
        <th style="width: 40%;">Description</th>
        <th style="width: 8%;">Unit</th>
        <th style="width: 10%;">Qty</th>
        <th style="width: 12%;">Rate</th>
        <th style="width: 13%;">Amount</th>
      </tr>
    </thead>
    <tbody>
      {% for item in line_items %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ item.xitem }}</td>
        <td class="left">{{ item.xitemdesc|default:item.xitem }}</td>
        <td>{{ item.xunit }}</td>
        <td>{{ item.xqtyord|bdt_with_decimals:2 }}</td>
        <td class="right">{{ item.xrate|bdt_with_decimals:2 }}</td>
        <td class="right">{{ item.xlineamt|bdt_with_decimals:2 }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <table class="summary-table">
    <tr>
      <td colspan="3" style="border: none;"></td>
      <td class="label">Total Return Amount in Tk:</td>
      <td class="amount">{{ totals.total_line_amount|bdt_with_decimals:2|default:"Tk 0.00" }}</td>
    </tr>
  </table>

  <div style="font-size: 10px; margin-top: 4px;">
    <strong>In Words:</strong> {{ totals.total_line_amount|inword_currency|default:"Zero Taka Only" }}
  </div>
  {% else %}
  <div style="margin: 50px 0; color: #666;">
    <h3 style="font-size: 14px;">NO RETURN DATA FOUND</h3>
    <p>No return details for: {{ transaction_no }}</p>
  </div>
  {% endif %}

  <!-- Notes -->
  <div style="font-size: 8px; font-weight: bold; margin-top: 5px;">
    <strong>Note:</strong> {{ header.xrem|default:"-" }}
  </div>

  <!-- Signature -->
  <table style="width: 100%; margin-top: 30px; font-size: 10px; text-align: center; border-collapse: collapse;">
    <tr>
      <td style="border-top: 1px solid #000; padding: 3px 0;">
        Prepared By {{ header.zemail|default:"-" }}
      </td>
      <td></td>
      <td style="border-top: 1px solid #000;">Authorized By</td>
      <td></td>
      <td style="border-top: 1px solid #000;">Return/Confirmed By</td>
      <td></td>
      <td style="border-top: 1px solid #000;">Received By</td>
    </tr>
  </table>

  <!-- Proper Footer (Fixed Bottom via @frame) -->
  <div id="footerContent">
    <div style="text-align: center; font-size: 9px; color: #000;">
      System Generated Voucher/Invoice : {{ header.ximtmptrn }}<br>
      Generated on: {{ print_date }} |
      Copyright Â© 2025
      <b>DreamErp BD</b> | Bashar@01675373799 | All Rights Reserved<br>
      Page <pdf:pagenumber /> of <pdf:pagecount />
    </div>
  </div>

</body>

</html>
