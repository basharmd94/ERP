{% extends 'reports/base_report.html' %}

{% block title %}Sales Return{% endblock %}
{% block header_title %}Sales Return{% endblock %}

{% block header_info %}
<!-- Optional: Hide date-range in base header for single-transaction prints -->
<style>
.date-range {
  display: none;
}

</style>
<div style="margin-bottom: 8px; ">
  <table style="width: 100%; border-collapse: collapse; font-size: 10px; ">
    <tr>
      <td style="width: 50%; text-align: left; border: 1px solid #000; padding: 4px;">
        <strong>Transaction No:</strong> {{ header.ximtmptrn }}<br>
        <strong>Warehouse:</strong> {{ header.xwh }}<br>
        <strong>Project:</strong> {{ header.xproj|default:"-" }}
      </td>
      <td style="width: 50%; text-align: right; border: 1px solid #000; padding: 4px;">
        <strong>Date:</strong> {{ header.xdate }}<br>
        <strong>GL Reference:</strong> {{ header.xglref|default:"-" }}<br>
        <strong>Status:</strong> {{ header.xstatustrn|default:"Processed" }}
      </td>
    </tr>
  </table>
</div>
{% endblock %}

{% block content %}
{% if line_items %}
<table cellspacing="0" cellpadding="2" width="100%" style="border-collapse: collapse; table-layout: fixed; margin: 8px 0; font-size: 9px;">
  <thead>
    <tr>
      <th style="border: 1px solid #000; width: 5%;">S.I.</th>
      <th style="border: 1px solid #000; width: 12%;">Code</th>
      <th style="border: 1px solid #000; width: 40%;">Description</th>
      <th style="border: 1px solid #000; width: 8%;">Unit</th>
      <th style="border: 1px solid #000; width: 10%;">Qty</th>
      <th style="border: 1px solid #000; width: 12%;">Rate</th>
      <th style="border: 1px solid #000; width: 13%;">Amount</th>
    </tr>
  </thead>
  <tbody>
    {% for item in line_items %}
    <tr>
      <td style="border: 1px solid #000;">{{ forloop.counter }}</td>
      <td style="border: 1px solid #000;">{{ item.xitem }}</td>
      <td style="border: 1px solid #000;" class="text-left">{{ item.xitemdesc|default:item.xitem }}</td>
      <td style="border: 1px solid #000;">{{ item.xunit }}</td>
      <td style="border: 1px solid #000;">{{ item.xqtyord|bdt_with_decimals:2 }}</td>
      <td style="border: 1px solid #000;" class="text-right">{{ item.xrate|bdt_with_decimals:2 }}</td>
      <td style="border: 1px solid #000;" class="text-right">{{ item.xlineamt|bdt_with_decimals:2 }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<table width="100%" style="border-collapse: collapse; font-size: 9px; margin: 5px 0;">
  <tr>
    <td colspan="3" style="border: none;"></td>
    <td style="border: 1px solid #000; text-align: left; padding: 2px 4px; width: 35%;"><strong>Total Return Amount in Tk:</strong></td>
    <td style="border: 1px solid #000; text-align: right; padding: 2px 4px; width: 15%;">{{ totals.total_line_amount|bdt_with_decimals:2|default:"Tk 0.00" }}</td>
  </tr>
</table>

<div style="font-size: 10px; margin-top: 4px;">
  <strong>In Words:</strong> {{ totals.total_line_amount|inword_currency|default:"Zero Taka Only" }}
</div>
{% else %}
<div style="margin: 50px 0; color: #666; text-align: center;">
  <h3 style="font-size: 14px;">NO RETURN DATA FOUND</h3>
  <p>No return details for: {{ transaction_no }}</p>
</div>
{% endif %}

<!-- Notes -->
<div style="font-size: 8px; font-weight: bold; margin-top: 5px;">
  <strong>Note:</strong> {{ header.xrem|default:"-" }}
</div>

<!-- Signature -->
<table width="100%" style="margin-top: 30px; font-size: 10px; text-align: center; border-collapse: collapse;">
  <tr>
    <td style="border-top: 1px solid #000; padding: 3px 0;">Prepared By {{ header.zemail|default:"-" }}</td>
    <td></td>
    <td style="border-top: 1px solid #000;">Authorized By</td>
    <td></td>
    <td style="border-top: 1px solid #000;">Return/Confirmed By</td>
    <td></td>
    <td style="border-top: 1px solid #000;">Received By</td>
  </tr>
</table>
{% endblock %}
