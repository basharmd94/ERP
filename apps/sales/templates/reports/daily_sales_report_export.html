{% extends 'reports/base_report.html' %}

{% block title %}Daily Sales Report{% endblock %}
{% block header_title %}Daily Sales Report{% endblock %}

{% block header_info %}
<div style="margin-bottom: 8px;">
  <table style="width: 100%; border-collapse: collapse; font-size: 10px;">
    <tr>
      <td style="width: 50%; text-align: left; border:1px solid black; padding: 4px;">
        <strong style = "margin-bottom: 4px;">Report Generated:</strong> {{ print_date }}<br>
        <strong style = "margin-bottom: 4px;">Total Records:</strong> {{ total_records }}
      </td>
      <td style="width: 50%; text-align: right; border:1px solid black; padding: 4px;">
        <strong style = "margin-bottom: 4px;">Date Range:</strong> {{ from_date }} to {{ to_date }}<br>
        <strong style = "margin-bottom: 4px;">Report Type:</strong> Daily Sales Summary
      </td>
    </tr>
  </table>

  {% endblock %}

  {% block content %}
  {% if sales_data %}
  <table border="1" cellspacing="0" cellpadding="4" width="100%" style="font-size: 9px;">
    <thead>
      <tr>
        <th style="width: 8%;">S.I.</th>
        <th style="width: 12%;">Date</th>
        <th style="width: 15%;">Order Number</th>
        <th style="width: 12%;">Bank</th>
        <th style="width: 13%;" class="text-right">Card Amount</th>
        <th style="width: 13%;" class="text-right">Cash Amount</th>
        <th style="width: 12%;" class="text-right">Discount</th>
        <th style="width: 15%;" class="text-right">Total</th>
      </tr>
    </thead>
    <tbody>
      {% for item in sales_data %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ item.xdate }}</td>
        <td class="text-left">{{ item.xordernum|default:"-" }}</td>
        <td class="text-left">{{ item.xsalescat|default:"-" }}</td>
        <td class="text-right">{{ item.xdtcomm|floatformat:2 }}</td>
        <td class="text-right">{{ item.cash_amount|floatformat:2 }}</td>
        <td class="text-right">{{ item.discount|floatformat:2 }}</td>
        <td class="text-right">{{ item.xtotamt|floatformat:2 }}</td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr>
        <td colspan="4" class="text-right"><strong>Grand Total:</strong></td>
        <td class="text-right"><strong>{{ grand_totals.total_card_amount|floatformat:2 }}</strong></td>
        <td class="text-right"><strong>{{ grand_totals.total_cash_amount|floatformat:2 }}</strong></td>
        <td class="text-right"><strong>{{ grand_totals.total_discount|floatformat:2 }}</strong></td>
        <td class="text-right"><strong>{{ grand_totals.grand_total|bdt_with_decimals:2|default:"Tk 0.00" }}</strong></td>
      </tr>
    </tfoot>
  </table>

  <!-- Summary Section -->
  <div style="margin-top: 20px;">
    <table style="width: 100%; border-collapse: collapse; font-size: 10px;">
      <tr>
        <td style="width: 70%; border: none;"></td>
        <td style="width: 30%; border: 1px solid #000; padding: 5px;">
          <strong>Report Summary</strong><br>
          Total Records: {{ total_records }}<br>
          Date Range: {{ from_date }} to {{ to_date }}
        </td>
      </tr>
    </table>
  </div>

  {% else %}
  <div style="margin: 50px 0; color: #666; text-align: center;">
    <h3 style="font-size: 14px;">NO SALES DATA FOUND</h3>
    <p>No sales records found for the period: {{ from_date }} to {{ to_date }}</p>
    <div style="font-size: 10px;">Total records: {{ total_records }}</div>
  </div>
  {% endif %}

  <div style="font-size: 8px; margin-top: 4px; text-align: left;">
    <strong>InWord:</strong> {{ grand_totals.grand_total|inword_currency|default:"Zero Taka Only" }}
  </div>

  <!-- Signature -->
  <table style="width: 100%; margin-top: 30px; font-size: 10px; text-align: center; border-collapse: collapse;">
    <tr>
      <td style="border-top: 1px solid #000; padding: 3px 0; width: 25%;">Prepared By</td>
      <td style="width: 25%;"></td>
      <td style="border-top: 1px solid #000; width: 25%;">Reviewed By</td>
      <td style="width: 25%;"></td>
      <td style="border-top: 1px solid #000; width: 25%;">Authorized By</td>
    </tr>
  </table>
  {% endblock %}
